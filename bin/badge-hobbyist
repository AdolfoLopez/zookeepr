#!/bin/sh
where=$1
IFS='#'
psql -A -t -F "#" -c "select person.firstname, person.lastname, registration.company, person.id, registration.dinner, registration.country ilike 'Austral%', case when registration.shell = '-' then registration.shelltext else registration.shell end, case when registration.editor = '-' then registration.editortext else registration.editor end, registration.silly_description, person.handle where registration.type in ('Hobbyist', 'Concession')  and person.id = registration.person_id and rego_invoice_payment.cost = rego_invoice_payment.dollars and rego_invoice_payment.payment is not null and rego_invoice_payment.rego = registration.id $where order by person.id, person.lastname asc;" | nl -s '#' -w 1 | while read NUM FIRST LAST COMPANY REG_ID DINNERS AUSTRALIAN SH ED THINGY HANDLE; do
	echo "$FIRST $LAST		$REG_ID	$DINNERS	$AUSTRALIAN	$SH	$ED	$THINGY	$HANDLE"
done
