=== added file 'JOSH-TODO'
--- JOSH-TODO	1970-01-01 00:00:00 +0000
+++ JOSH-TODO	2008-05-18 08:37:21 +0000
@@ -0,0 +1,47 @@
+LCA09 TODO:
+(Mostly taken from docs/todo.html - a lot of these may be done)
+
+	Timeframe:
+		** CFP
+			Website up with zookpr running to receive papers
+		** CFP Close (call for mini-confs closes here final)
+		** Re-open CFP
+		** CFP Close
+		** Paper Assessment
+			Paper Committee
+		** F2F meeting
+		** Finalise Programme
+			Publish Programme (web)
+		** EB tickets on sale
+		** EB end
+
+	Terminology:
+		Call for presentations/papers/talks?
+		Registration is used in too many places
+
+	Theme/Design:
+		Fix up template files with proper CSS (things like radio buttons aren't padded correctly etc).
+		Design Attractive homepage for placing annoucements on. Perhaps a count down to conference etc
+			Call for mini-confs
+			Call for presentations
+			Reopening of CFP
+			Call for presentations closed
+			Early birds opening soon
+			Early birds avaliable
+			Early birds over
+			Conference countdown
+			Todays news (for at the conference)
+
+	Registration:
+		Make sure the form shows earlybird prices when appropriate 
+		speakers - hotel / college preference 
+		Why is the company called "SecurePay", the form is processed by "SafePay" and the explanations are from "DirectOne"? 
+
+	Accomidation:
+		Set up a config file for details rather then hackery
+		Integrate Wrest Point booking system?
+
+	At Conference:
+		A more structured way of handling at-conference talk attachments - videos in multiple formats, slides, additional files
+	
+	Payment:

=== modified file 'zookeepr.egg-info/paste_deploy_config.ini_tmpl'
--- zookeepr.egg-info/paste_deploy_config.ini_tmpl	2008-05-13 15:00:44 +0000
+++ zookeepr.egg-info/paste_deploy_config.ini_tmpl	2008-05-18 13:03:18 +0000
@@ -1,13 +1,10 @@
-#
 # zookeepr - Pylons configuration
-#
 # The %(here) variable will be replaced with the parent directory of this file
-#
 [DEFAULT]
-debug = false
-email_to = you@yourdomain.com
-smtp_server = localhost
-error_email_from = paste@exceptions.com
+debug = true
+email_to = josh@nitrotech.org
+smtp_server = mail.internode.on.net
+error_email_from = josh@nitrotech.org
 
 [server:main]
 use = egg:Paste#http
@@ -16,41 +13,20 @@
 
 [app:main]
 use = egg:zookeepr
-myghty_data_dir = %(here)s/data/templates
-cache_data_dir = %(here)s/data/cache
+data_dir = %(here)s/data/templates
 dynamic_html_dir = %(here)s/data/dynamic_html
-session_data_dir = %(here)s/data/sessions
-session_key = zookeepr
-session_secret = ${app_instance_secret}
-app_instance_uuid = ${app_instance_uuid}
-
-# When using MoinMoin as our mash-in wiki fallback, we need to
-# specify where to set up the data and underlay directories.
-# Use 'paster setup-app' to populate these on a new install.
-moin_data = %(here)s/moin/data
-moin_underlay = %(here)s/moin_underlay
-
-# Possible statuses not_open|open|closed
-cfp_status = open
-registration_status = not_open
-# Wether we are collecting miniconfs or papers
-cfp_mode = miniconf
+app_instance_uuid = {23c37553-c244-4ea2-ac71-fff823bcfbd6}
 
 # We're using SQLAlchemy, the database is initialised in
 # `Globals.__init__()`, and connected to per thread/request in
 # `BaseController.__call__()`.  Note the URL syntax depends
 # on the SQLAlchemy documentation for `global_connect`.
-dburi = sqlite://filename=%(here)s/somedb.db
+#dburi = sqlite://%(here)s/somedb.db
+#dburi = sqlite:///somedb.db
+dburi = postgres://postgres:pass@localhost/zookeepr
 # echo_queries = true
 
-# CommSecure (the payment gateway provider) requires a Merchant ID
-# and a shared secret
-commsecure_merchantid = TestZookeeprMerchantID
-commsecure_secret = zing
-
-# Contact email for the committee
-contact_email = contact@yourdomain.com
-webmaster_email = contact@yourdomain.com
-
-# Name of the event
-event_name = linux.conf.au 20XX
+
+#CHANGE THESE:
+host_name = localhost
+webmaster_email = webmaster@linux.conf.au

=== modified file 'zookeepr/config/environment.py'
--- zookeepr/config/environment.py	2008-04-27 06:51:46 +0000
+++ zookeepr/config/environment.py	2008-05-18 12:06:05 +0000
@@ -10,6 +10,7 @@
 import zookeepr.lib.helpers
 
 from zookeepr.config.routing import make_map
+from zookeepr.config.lca import config as lca_config
 
 def load_environment(global_conf, app_conf):
     # Setup our paths
@@ -43,7 +44,7 @@
     # escaping functions, for great justice.
     # http://www.myghty.org/docs/filtering.myt#filtering_escaping_custom
     myghty['escapes'] = {'l': webhelpers.auto_link,
-                         's': webhelpers.simple_format,
+                         's': webhelpers.simple_format
                          }
     
     # Add your own Myghty config options here, note that all config options will override

=== added file 'zookeepr/config/lca_info.py'
--- zookeepr/config/lca_info.py	1970-01-01 00:00:00 +0000
+++ zookeepr/config/lca_info.py	2008-05-18 13:20:21 +0000
@@ -0,0 +1,25 @@
+# File for holding configuration relative to the current LCA
+# This could be dberised sometimes
+
+lca_info = {
+# CommSecure (the payment gateway provider) requires a Merchant ID
+# and a shared secret
+  'commsecure_merchantid' : 'TestZookeeprMerchantID',
+  'commsecure_secret' : 'zing',
+
+# Contact email for the committee
+  'contact_email' : 'josh@nitrotech.org',
+  'event_name' : 'linux.conf.au 2009',
+
+# Possible statuses not_open|open|closed
+  'cfp_status' : 'not_open',
+  'cfmini_status' : 'open',
+  'registration_status' : 'not_open',
+# Wether we are collecting miniconfs or papers.
+  'mini_conf_email' : 'miniconfs@marchsouth.org',
+  
+# Available Tickets
+  'total_ticets' = 700,
+  'speakers_coming' = 70 # hard coded to the number of speakers... do we need this since speakers register?
+}
+

=== modified file 'zookeepr/controllers/admin.py'
--- zookeepr/controllers/admin.py	2008-05-14 09:16:24 +0000
+++ zookeepr/controllers/admin.py	2008-05-16 11:43:00 +0000
@@ -806,7 +806,8 @@
 	c.talks += self.dbsession.query(Proposal).filter_by(proposal_type_id=4).all()
 
 	res = render_response('admin/acc_papers_xml.myt', fragment=True)
-	res.headers['Content-type']='text/plain; charset=utf-8'
+	#res.headers['Content-type']='text/plain; charset=utf-8'
+	# res has no attribute headers?
 	return res
     def paid_summary(self):
         """ Summary of paid invoices. [rego] """

=== modified file 'zookeepr/controllers/cfp.py'
--- zookeepr/controllers/cfp.py	2008-05-05 07:57:08 +0000
+++ zookeepr/controllers/cfp.py	2008-05-18 12:53:55 +0000
@@ -10,6 +10,8 @@
 from zookeepr.lib.validators import BaseSchema, ProposalTypeValidator, FileUploadValidator, AssistanceTypeValidator
 from zookeepr.model import ProposalType, Proposal, Attachment, AssistanceType
 
+from zookeepr.config.lca_info import lca_info
+
 class PersonSchema(Schema):
     experience = validators.String()
     bio = validators.String(not_empty=True)
@@ -57,8 +59,8 @@
     anon_actions = ['index']
 
     def __init__(self, *args):
-        c.cfp_status = request.environ['paste.config']['app_conf'].get('cfp_status')
-        c.cfmini_status = request.environ['paste.config']['app_conf'].get('cfmini_status')
+        c.cfp_status = lca_info['cfp_status']
+        c.cfmini_status = lca_info['cfmini_status']
 
 
         # Anyone can submit while the CFP is open
@@ -149,7 +151,7 @@
                     c.proposal.attachments.append(c.attachment)
 
                 email((c.person.email_address, 
-                          request.environ['paste.config']['app_conf'].get('mini_conf_email')),
+                          lca_info['mini_conf_email']),
                       render('cfp/thankyou_mini_email.myt', fragment=True))
 
                 return render_response('cfp/thankyou_mini.myt')

=== modified file 'zookeepr/controllers/invoice.py'
--- zookeepr/controllers/invoice.py	2008-01-25 07:00:17 +0000
+++ zookeepr/controllers/invoice.py	2008-05-18 12:39:49 +0000
@@ -7,6 +7,8 @@
 from zookeepr.lib.auth import *
 from zookeepr.lib.crud import *
 
+from zookeepr.config.lca_info import lca_info
+
 class InvoiceController(SecureController, Read, List):
     model = model.Invoice
     individual = 'invoice'
@@ -38,8 +40,8 @@
 	    return render_response('invoice/invalid.myt')
 
         # get our merchant id and secret
-        merchant_id = request.environ['paste.config']['app_conf'].get('commsecure_merchantid')
-        secret = request.environ['paste.config']['app_conf'].get('commsecure_secret')
+        merchant_id = lca_info['commsecure_merchantid']
+        secret = lca_info['commsecure_secret']
 
         # create payment entry
         payment = model.Payment()

=== modified file 'zookeepr/controllers/payment.py'
--- zookeepr/controllers/payment.py	2007-10-10 17:15:48 +0000
+++ zookeepr/controllers/payment.py	2008-05-18 12:39:47 +0000
@@ -6,6 +6,8 @@
 from zookeepr.lib.crud import *
 from zookeepr.lib.mail import *
 
+from zookeepr.config.lca_info import lca_info
+
 class PaymentController(BaseController, Create, View):
     """This controller receives payment advice from CommSecure.
 
@@ -102,8 +104,8 @@
 
 
     def _verify_hmac(self, fields):
-        merchantid =  request.environ['paste.config']['app_conf'].get('commsecure_merchantid')
-        secret =  request.environ['paste.config']['app_conf'].get('commsecure_secret')
+        merchantid = lca_info['commsecure_merchantid']
+        secret =  lca_info['commsecure_secret']
 
         # Check for MAC
         if 'MAC' not in fields:
@@ -124,5 +126,5 @@
 
 
     def _mail_warn(self, msg, pr):
-        email(request.environ['paste.config']['app_conf'].get('contact_email'),
+        email(lca_info['contact_email'],
 	    render('payment/warning.myt', fragment=True, subject=msg, pr=pr))

=== modified file 'zookeepr/lib/auth.py'
--- zookeepr/lib/auth.py	2008-04-27 06:20:10 +0000
+++ zookeepr/lib/auth.py	2008-05-16 11:36:58 +0000
@@ -202,6 +202,6 @@
         self.role_name = role_name
 
     def authorise(self, cls):
-        role = cls.dbsession.query(Role).filter_by(name=self.role_name).one()
+        role = cls.dbsession.query(Role).filter_by(name=self.role_name).first()
         retval = role in c.signed_in_person.roles
         return retval

=== modified file 'zookeepr/lib/helpers.py'
--- zookeepr/lib/helpers.py	2007-10-30 06:23:40 +0000
+++ zookeepr/lib/helpers.py	2008-05-18 12:40:43 +0000
@@ -10,6 +10,7 @@
 from glob import glob
 import os.path, random, array
 import re
+from zookeepr.config.lca_info import lca_info
 
 def counter(*args, **kwargs):
     """Return the next cardinal in a sequence.
@@ -94,9 +95,9 @@
     Renders a link to the committee; optionally takes a text, which will be
     the text of the anchor (defaults to the e-mail address).
     """
-    email = request_config().environ['paste.config']['app_conf']['contact_email']
-    if text==None:
-      text = '<tt>'+email+'</tt>'
+    email = lca_info['contact_email']
+    if text == None:
+        text = '<tt>'+email+'</tt>'
     return '<a href="mailto:'+email+'">'+text+'</a>'
 
 def host_name():
@@ -111,7 +112,7 @@
 
     Returns the name of the event we're running (yay).
     """
-    return request_config().environ['paste.config']['app_conf']['event_name']
+    return lca_info['event_name']
 
 def get_temperature():
     """ Fetch temperature from the BOM website.

=== modified file 'zookeepr/lib/mail.py'
--- zookeepr/lib/mail.py	2007-05-15 03:15:39 +0000
+++ zookeepr/lib/mail.py	2008-05-18 12:40:06 +0000
@@ -1,12 +1,13 @@
 import smtplib
 from zookeepr.lib.base import *
+from zookeepr.config.lca_info import lca_info
 
 def email(recipients, body):
     try:
 	s = smtplib.SMTP(
 	    request.environ['paste.config']['global_conf'].get('smtp_server'))
 	s.sendmail(
-            request.environ['paste.config']['app_conf'].get('contact_email'),
+            lca_info['contact_email'],
             recipients, body)
 	s.quit()
     except:

=== modified file 'zookeepr/templates/cfp/list.myt'
--- zookeepr/templates/cfp/list.myt	2007-04-21 09:31:30 +0000
+++ zookeepr/templates/cfp/list.myt	2008-05-18 12:48:23 +0000
@@ -1,7 +1,7 @@
 
-% if c.cfp_status == 'not_open':
+% if h.lca_info['cfp_status'] == 'not_open':
       The CFP is not open.
-% elif c.cfp_status == 'open':
+% elif h.lca_info['cfp_status'] == 'open':
 <p id="cfpbutton" class="right"><% h.link_to('<img src="/cfp-go.png" alt="Call for Papers" /><br />Submit a paper for linux.conf.au 2008!', url=h.url_for('submit_cfp')) %></p>
 % else:
       The CFP is closed.

=== modified file 'zookeepr/templates/invoice/pdf.myt'
--- zookeepr/templates/invoice/pdf.myt	2008-01-07 22:28:02 +0000
+++ zookeepr/templates/invoice/pdf.myt	2008-05-18 13:11:46 +0000
@@ -42,6 +42,7 @@
 % # endif
 
   <event><% h.event_name() %></event>
+  <contact><% h.lca_info['contact_email'] %></contact>
 
   <itemcount><% len(c.invoice.items) %></itemcount>
   <items>

=== modified file 'zookeepr/templates/profile/view.myt'
--- zookeepr/templates/profile/view.myt	2008-05-13 14:39:08 +0000
+++ zookeepr/templates/profile/view.myt	2008-05-18 12:52:21 +0000
@@ -227,7 +227,7 @@
 <& actions &>
 
 %   else:
-%       if c.registration_status == 'open':
+%       if h.lca_info['registration_status'] == 'open':
 <p>
 You haven't yet registered for the conference.  <% h.link_to('Register now!', url=h.url('/Registration')) %>
 </p>

